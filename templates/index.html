<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bilibili Video Downloader</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="container">
    <h1>ðŸŽ¬ Bilibili Video Downloader</h1>
    <input type="text" id="url" placeholder="Enter Bilibili URL" />
    <button id="downloadBtn">Start Download</button>
    <div id="status"></div>
    <div id="progressContainer">
        <div id="progressBar"></div>
    </div>
</div>

<script>
document.getElementById('downloadBtn').onclick = async function () {
    const url = document.getElementById('url').value;
    if (!url) return alert('Enter a URL!');

    document.getElementById('status').innerText = 'Downloading...';
    const progressBar = document.getElementById('progressBar');
    progressBar.style.width = '0%';

    try {
        const formData = new FormData();
        formData.append('url', url);

        const res = await fetch('/download', {
            method: 'POST',
            body: formData
        });

        const data = await res.json();

        if (data.error) {
            document.getElementById('status').innerText = "Error: " + data.error;
        } else {
            progressBar.style.width = '100%';
            document.getElementById('status').innerHTML = `<a href="${data.file}">Download Ready! Click Here</a>`;
        }

    } catch (err) {
        document.getElementById('status').innerText = 'Error: ' + err;
    }
};
</script>
</body>
</html>
